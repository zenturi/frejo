// Generated by Haxe 4.0.0-preview.4+1e3e5e0
#include <hxcpp.h>

#ifndef INCLUDED_snow_Snow
#include <snow/Snow.h>
#endif
#ifndef INCLUDED_snow_api_Promise
#include <snow/api/Promise.h>
#endif
#ifndef INCLUDED_snow_core_native_io_IO
#include <snow/core/native/io/IO.h>
#endif
#ifndef INCLUDED_snow_modules_interfaces_IO
#include <snow/modules/interfaces/IO.h>
#endif
#ifndef INCLUDED_snow_modules_sdl_IO
#include <snow/modules/sdl/IO.h>
#endif
#ifndef INCLUDED_snow_systems_io_IO
#include <snow/systems/io/IO.h>
#endif

HX_DEFINE_STACK_FRAME(_hx_pos_2929d4353300c1f8_23_new,"snow.systems.io.IO","new",0xbb4a146b,"snow.systems.io.IO.new","snow/systems/io/IO.hx",23,0x7ba838c6)
HX_LOCAL_STACK_FRAME(_hx_pos_2929d4353300c1f8_76_data_flow,"snow.systems.io.IO","data_flow",0x7dfea3ae,"snow.systems.io.IO.data_flow","snow/systems/io/IO.hx",76,0x7ba838c6)
HX_LOCAL_STACK_FRAME(_hx_pos_2929d4353300c1f8_73_data_flow,"snow.systems.io.IO","data_flow",0x7dfea3ae,"snow.systems.io.IO.data_flow","snow/systems/io/IO.hx",73,0x7ba838c6)
HX_LOCAL_STACK_FRAME(_hx_pos_2929d4353300c1f8_67_data_flow,"snow.systems.io.IO","data_flow",0x7dfea3ae,"snow.systems.io.IO.data_flow","snow/systems/io/IO.hx",67,0x7ba838c6)
HX_LOCAL_STACK_FRAME(_hx_pos_2929d4353300c1f8_208_default_provider,"snow.systems.io.IO","default_provider",0x16d740c4,"snow.systems.io.IO.default_provider","snow/systems/io/IO.hx",208,0x7ba838c6)
HX_LOCAL_STACK_FRAME(_hx_pos_2929d4353300c1f8_220_shutdown,"snow.systems.io.IO","shutdown",0xdecc30ab,"snow.systems.io.IO.shutdown","snow/systems/io/IO.hx",220,0x7ba838c6)
namespace snow{
namespace systems{
namespace io{

void IO_obj::__construct( ::snow::Snow _app){
            	HX_GC_STACKFRAME(&_hx_pos_2929d4353300c1f8_23_new)
HXLINE(  25)		this->app = _app;
HXLINE(  26)		this->module =  ::snow::modules::sdl::IO_obj::__alloc( HX_CTX ,this->app);
            	}

Dynamic IO_obj::__CreateEmpty() { return new IO_obj; }

void *IO_obj::_hx_vtable = 0;

Dynamic IO_obj::__Create(hx::DynamicArray inArgs)
{
	hx::ObjectPtr< IO_obj > _hx_result = new IO_obj();
	_hx_result->__construct(inArgs[0]);
	return _hx_result;
}

bool IO_obj::_hx_isInstanceOf(int inClassId) {
	return inClassId==(int)0x00000001 || inClassId==(int)0x7eecf769;
}

 ::snow::api::Promise IO_obj::data_flow(::String _id, ::Dynamic _processor, ::Dynamic _provider){
            		HX_BEGIN_LOCAL_FUNC_S4(hx::LocalFunc,_hx_Closure_1, ::snow::systems::io::IO,_gthis, ::Dynamic,_provider,::String,_id, ::Dynamic,_processor) HXARGC(2)
            		void _hx_run( ::Dynamic resolve, ::Dynamic reject){
            			HX_BEGIN_LOCAL_FUNC_S5(hx::LocalFunc,_hx_Closure_0, ::snow::systems::io::IO,_gthis,::String,_id, ::Dynamic,resolve, ::Dynamic,reject, ::Dynamic,_processor) HXARGC(1)
            			void _hx_run( ::Dynamic data){
            				HX_STACKFRAME(&_hx_pos_2929d4353300c1f8_76_data_flow)
HXLINE(  76)				if (hx::IsNotNull( _processor )) {
HXLINE(  77)					( ( ::snow::api::Promise)(_processor(_gthis->app,_id,data)) )->then(resolve,reject);
            				}
            				else {
HXLINE(  79)					resolve(data);
            				}
            			}
            			HX_END_LOCAL_FUNC1((void))

            			HX_STACKFRAME(&_hx_pos_2929d4353300c1f8_73_data_flow)
HXLINE(  73)			( ( ::snow::api::Promise)(_provider(_gthis->app,_id)) )->then( ::Dynamic(new _hx_Closure_0(_gthis,_id,resolve,reject,_processor)),null())->error(reject);
            		}
            		HX_END_LOCAL_FUNC2((void))

            	HX_GC_STACKFRAME(&_hx_pos_2929d4353300c1f8_67_data_flow)
HXDLIN(  67)		 ::snow::systems::io::IO _gthis = hx::ObjectPtr<OBJ_>(this);
HXLINE(  69)		if (hx::IsNull( _provider )) {
HXLINE(  69)			_provider = this->default_provider_dyn();
            		}
HXLINE(  71)		return  ::snow::api::Promise_obj::__alloc( HX_CTX , ::Dynamic(new _hx_Closure_1(_gthis,_provider,_id,_processor)));
            	}


HX_DEFINE_DYNAMIC_FUNC3(IO_obj,data_flow,return )

 ::snow::api::Promise IO_obj::default_provider( ::snow::Snow _app,::String _id){
            	HX_STACKFRAME(&_hx_pos_2929d4353300c1f8_208_default_provider)
HXDLIN( 208)		return this->module->data_load(_id,null());
            	}


HX_DEFINE_DYNAMIC_FUNC2(IO_obj,default_provider,return )

void IO_obj::shutdown(){
            	HX_STACKFRAME(&_hx_pos_2929d4353300c1f8_220_shutdown)
HXDLIN( 220)		this->module->shutdown();
            	}


HX_DEFINE_DYNAMIC_FUNC0(IO_obj,shutdown,(void))


hx::ObjectPtr< IO_obj > IO_obj::__new( ::snow::Snow _app) {
	hx::ObjectPtr< IO_obj > __this = new IO_obj();
	__this->__construct(_app);
	return __this;
}

hx::ObjectPtr< IO_obj > IO_obj::__alloc(hx::Ctx *_hx_ctx, ::snow::Snow _app) {
	IO_obj *__this = (IO_obj*)(hx::Ctx::alloc(_hx_ctx, sizeof(IO_obj), true, "snow.systems.io.IO"));
	*(void **)__this = IO_obj::_hx_vtable;
	__this->__construct(_app);
	return __this;
}

IO_obj::IO_obj()
{
}

void IO_obj::__Mark(HX_MARK_PARAMS)
{
	HX_MARK_BEGIN_CLASS(IO);
	HX_MARK_MEMBER_NAME(app,"app");
	HX_MARK_MEMBER_NAME(module,"module");
	HX_MARK_END_CLASS();
}

void IO_obj::__Visit(HX_VISIT_PARAMS)
{
	HX_VISIT_MEMBER_NAME(app,"app");
	HX_VISIT_MEMBER_NAME(module,"module");
}

hx::Val IO_obj::__Field(const ::String &inName,hx::PropertyAccess inCallProp)
{
	switch(inName.length) {
	case 3:
		if (HX_FIELD_EQ(inName,"app") ) { return hx::Val( app ); }
		break;
	case 6:
		if (HX_FIELD_EQ(inName,"module") ) { return hx::Val( module ); }
		break;
	case 8:
		if (HX_FIELD_EQ(inName,"shutdown") ) { return hx::Val( shutdown_dyn() ); }
		break;
	case 9:
		if (HX_FIELD_EQ(inName,"data_flow") ) { return hx::Val( data_flow_dyn() ); }
		break;
	case 16:
		if (HX_FIELD_EQ(inName,"default_provider") ) { return hx::Val( default_provider_dyn() ); }
	}
	return super::__Field(inName,inCallProp);
}

hx::Val IO_obj::__SetField(const ::String &inName,const hx::Val &inValue,hx::PropertyAccess inCallProp)
{
	switch(inName.length) {
	case 3:
		if (HX_FIELD_EQ(inName,"app") ) { app=inValue.Cast<  ::snow::Snow >(); return inValue; }
		break;
	case 6:
		if (HX_FIELD_EQ(inName,"module") ) { module=inValue.Cast<  ::snow::modules::sdl::IO >(); return inValue; }
	}
	return super::__SetField(inName,inValue,inCallProp);
}

void IO_obj::__GetFields(Array< ::String> &outFields)
{
	outFields->push(HX_("app",a1,fc,49,00));
	outFields->push(HX_("module",ac,34,d3,c0));
	super::__GetFields(outFields);
};

#ifdef HXCPP_SCRIPTABLE
static hx::StorageInfo IO_obj_sMemberStorageInfo[] = {
	{hx::fsObject /*::snow::Snow*/ ,(int)offsetof(IO_obj,app),HX_("app",a1,fc,49,00)},
	{hx::fsObject /*::snow::modules::sdl::IO*/ ,(int)offsetof(IO_obj,module),HX_("module",ac,34,d3,c0)},
	{ hx::fsUnknown, 0, null()}
};
static hx::StaticInfo *IO_obj_sStaticStorageInfo = 0;
#endif

static ::String IO_obj_sMemberFields[] = {
	HX_("app",a1,fc,49,00),
	HX_("module",ac,34,d3,c0),
	HX_("data_flow",63,45,91,a9),
	HX_("default_provider",af,6f,f5,8b),
	HX_("shutdown",96,fc,0b,6b),
	::String(null()) };

hx::Class IO_obj::__mClass;

void IO_obj::__register()
{
	IO_obj _hx_dummy;
	IO_obj::_hx_vtable = *(void **)&_hx_dummy;
	hx::Static(__mClass) = new hx::Class_obj();
	__mClass->mName = HX_("snow.systems.io.IO",f9,02,1f,f5);
	__mClass->mSuper = &super::__SGetClass();
	__mClass->mConstructEmpty = &__CreateEmpty;
	__mClass->mConstructArgs = &__Create;
	__mClass->mGetStaticField = &hx::Class_obj::GetNoStaticField;
	__mClass->mSetStaticField = &hx::Class_obj::SetNoStaticField;
	__mClass->mStatics = hx::Class_obj::dupFunctions(0 /* sStaticFields */);
	__mClass->mMembers = hx::Class_obj::dupFunctions(IO_obj_sMemberFields);
	__mClass->mCanCast = hx::TCanCast< IO_obj >;
#ifdef HXCPP_SCRIPTABLE
	__mClass->mMemberStorageInfo = IO_obj_sMemberStorageInfo;
#endif
#ifdef HXCPP_SCRIPTABLE
	__mClass->mStaticStorageInfo = IO_obj_sStaticStorageInfo;
#endif
	hx::_hx_RegisterClass(__mClass->mName, __mClass);
}

} // end namespace snow
} // end namespace systems
} // end namespace io
